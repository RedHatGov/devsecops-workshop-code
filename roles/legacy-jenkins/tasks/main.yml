---
- name: Ensure namespace exists
  k8s:
    kubeconfig: '{{ kubeconfig }}'
    definition:
      apiVersion: v1
      kind: Namespace
      metadata:
        name: '{{ jenkins_project_name }}'
        annotations:
          openshift.io/display-name: '{{ jenkins_project_display }}'
      spec: {}

- name: Create a Jenkins instance
  k8s:
    kubeconfig: '{{ kubeconfig }}'
    namespace: '{{ jenkins_project_name }}'
    definition: '{{ lookup("template", "jenkins.yml.j2")|from_yaml }}'